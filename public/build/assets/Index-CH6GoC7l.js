import{V as S,b as h,j as e,M as D,r as t,U as f,c as j}from"./app-Bc_-2s0E.js";import{a as E,b as k}from"./index-e7_T2kQ8.js";import{u as L,a as B,B as F}from"./useAppUrl-BTnLDpLD.js";import{A as U}from"./AuthenticatedLayout-CyX_iFAO.js";import{F as M,T as R}from"./TablePagination-Kgtpd3ta.js";import"./iconBase-DVeOcSGg.js";import"./transition-Dbu1amtD.js";const x=["Lastname","Firstname","Middlename",""],Y=({auth:$})=>{const y=L(),b=async({queryKey:s})=>{const[a,o,d,m,T]=s;return(await j.get(`${y}/api/get_author_paginate`,{params:{page:o,lastname:d,sortColumn:m,sortDirection:T}})).data},{authors:c}=S().props,[u,N]=h.useState(""),[i,p]=h.useState((c==null?void 0:c.current_page)||1),[n,l]=h.useState({column:"",direction:"asc"}),{data:r,error:q,isLoading:v,refetch:g}=B({queryKey:["authors",i,u,n.column,n.direction],queryFn:b,keepPreviousData:!0}),w=s=>{const a=s.target.value;N(a),a||p(1)},A=s=>{p(s)},_=s=>{let a=n.direction==="asc"?"desc":"asc";s==="Accession No"?l({column:"accession_no",direction:a}):s==="Author Name"?l({column:"author_lastname",direction:a}):s==="Title"?l({column:"title",direction:a}):s==="Year"?l({column:"year",direction:a}):s==="Copies"?l({column:"copies",direction:a}):s==="Course"?l({column:"course",direction:a}):s==="Date Process"?l({column:"date_process",direction:a}):s==="Page No"&&l({column:"page_number",direction:a})},C=(r==null?void 0:r.data.map(s=>({id:s.id,firstname:s.firstname,middlename:s.middlename??"",lastname:s.lastname})))||[],P=async s=>{if(window.confirm("Are you sure you want to delete this author?"))try{const o=await j.delete(`/admin/authors/${s}`);alert("Author deleted successfully!"),g()}catch(o){console.log(o),alert("Author deleted successfully!"),g()}};return e.jsxs(U,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-green-100 ",children:"Author Page"}),children:[e.jsx(D,{title:"Authors"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-5xl sm:px-6 lg:px-5",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6 text-gray-900",children:e.jsxs(t.Card,{className:"h-full w-full",children:[e.jsxs(t.CardHeader,{floated:!1,shadow:!1,className:"rounded-none",children:[e.jsx("div",{className:"mb-8 flex items-center justify-between gap-8",children:e.jsx("div",{children:e.jsx(t.Typography,{variant:"h5",color:"blue-gray",children:"Author List"})})}),e.jsxs("div",{className:"flex flex-col items-center justify-between gap-4 md:flex-row",children:[e.jsx("div",{className:"w-full md:w-80 flex",children:e.jsx(t.Input,{label:"Search for lastname...",value:u,onChange:w})}),e.jsx("div",{className:"flex shrink-0 flex-col gap-6 sm:flex-row",children:e.jsx(f,{href:route("authors.create"),children:e.jsxs(t.Button,{color:"blue",className:"flex items-center gap-1 rounded",size:"sm",children:[e.jsx(E,{strokeWidth:2,className:"h-5 w-5"}),"Add Author"]})})})]})]}),e.jsx(t.CardBody,{className:"overflow-y-scroll px-0",children:e.jsxs("table",{className:"mt-4 w-full min-w-max table-auto text-left",children:[e.jsx("thead",{children:e.jsx("tr",{children:x.map((s,a)=>e.jsx("th",{onClick:()=>_(s),className:"border border-blue-gray-100 bg-blue-gray-50/50 p-4 cursor-pointer",children:e.jsxs(t.Typography,{variant:"small",color:"blue-gray",className:"flex items-center justify-between gap-2 font-semibold leading-none ",children:[s,a!==x.length-1&&e.jsx(M,{strokeWidth:2,className:`h-4 w-4 transform transition-transform ${n.column===s&&n.direction==="asc"?"rotate-180":""}`})]})},s))})}),e.jsx("tbody",{children:v?e.jsx("tr",{children:e.jsx("td",{colSpan:x.length,className:"border border-blue-gray-100 p-4",children:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(t.Spinner,{className:"h-10 w-10",color:"green"})})})}):C.map(({id:s,firstname:a,middlename:o,lastname:d},m)=>e.jsxs("tr",{className:"hover:bg-blue-gray-50 ",children:[e.jsx("td",{className:"border border-blue-gray-100 py-3 px-4",children:e.jsx(t.Typography,{variant:"small",className:"font-normal text-gray-800",children:d})}),e.jsx("td",{className:"border border-blue-gray-100 px-4",children:e.jsx(t.Typography,{variant:"small",className:"font-normal text-gray-800",children:a})}),e.jsx("td",{className:"border border-blue-gray-100 px-4",children:e.jsx(t.Typography,{variant:"small",className:"font-normal text-gray-800",children:o})}),e.jsx("td",{className:"border border-blue-gray-100 px-4",children:e.jsxs("div",{className:"flex items-center gap-2 ",children:[e.jsx(t.Tooltip,{content:"Edit Author",children:e.jsx(f,{className:"hover:bg-blue-800 hover:rounded hover:text-white",href:route("authors.edit",{id:s}),children:e.jsx(F,{className:"text-2xl"})})}),e.jsx(t.Tooltip,{content:"Delete Author",children:e.jsx("button",{className:"text-red-800 hover:bg-blue-800 hover:rounded",onClick:()=>P(s),children:e.jsx(k,{className:"text-2xl font-bold"})})})]})})]},m))})]})}),e.jsxs(t.CardFooter,{className:"grid grid-cols-4 items-center border-t border-blue-gray-50 p-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs(t.Typography,{variant:"small",color:"blue-gray",className:"font-normal",children:["Page ",r==null?void 0:r.current_page," of"," ",r==null?void 0:r.last_page]})}),e.jsxs("div",{className:"col-span-2 flex flex-col items-center",children:[e.jsx(R,{currentPage:(r==null?void 0:r.current_page)||1,lastPage:(r==null?void 0:r.last_page)||1,onPageChange:A}),e.jsxs("div",{className:"mt-3 text-gray-700",children:["Showing ",(i-1)*10+1," ","to"," ",Math.min(i*10,r==null?void 0:r.total)," ","of ",r==null?void 0:r.total," entries"]})]})]})]})})})})})]})};export{Y as default};
